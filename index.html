<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Snuffy: Efficient Whole Slide Image Classifier has new Sparse Transformer and uses Parameter Efficient Finetuning">
  <meta name="keywords" content="Whole Slide Image (WSI), Self-Supervised Learning (SSL), Sparse Transformer, Multiple Instance Learning (MIL)">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Snuffy: Efficient Whole Slide Image Classifier</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://snuffy.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Snuffy: Efficient Whole Slide Image Classifier</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="jafarinia.github.io">Hossein Jafarinia</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="google.com">Alireza Alipanah</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="google.com">Danial Hamdi</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://saeidrazavi.github.io">Saeed Razavi</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=7IaTpQQAAAAJ&hl=en">Nahal Mirzaie</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://sharif.ir/~rohban/">Mohammad Hossein Rohban</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Sharif University of Technology,</span>
            <span class="author-block"><sup>2</sup>Amirkabir University of Technology (Tehran Polytechnic)</span>
          </div>

          <div class="column is-full_width">
            <h2 class="title is-4">ECCV 2024</h2>
          </div>

          <section class="section">
            <div class="container is-max-desktop">
          
              <div class="columns is-centered has-text-centered">
                <div class="column is-full-width">
                  <h2 class="title is-3">Overview</h2>
          
                  <img src="static/images/architecture.png" class="center">
                  <figcaption class="has-text-justified"><b>Overview of Snuffy</b> (a) The WSIs are segmented into 256 X 256 patches at 20X magnification, followed by embedding extraction via a pre-trained ViT. Subsequently, these embeddings are inputted into the Snuffy for patch and WSI classification. (b) The connectivity matrix illustrates the Snuffy attention sparsity patterns, with Class-related Global Attentions, highlighted in darker colors either vertical or horizontal (the darker the more important), Diagonal Attentions depicted with pink, and Random Global Attentions shown in the lightest pink.</figcaption>
          
                </div>
              </div>
          
            </div>
          </section>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2408.08258"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2408.08258"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/jafarinia/snuffy"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Whole Slide Image (WSI) classification with multiple instance learning (MIL) in digital pathology faces significant computational challenges. Current methods mostly rely on extensive self-supervised learning (SSL) for satisfactory performance, requiring long training periods and considerable computational resources. At the same time, no pre-training affects performance due to domain shifts from natural images to WSIs.
We introduce Snuffy architecture, a novel MIL-pooling method based on sparse transformers that mitigates performance loss with limited pre-training and enables continual few-shot pre-training as a competitive option. Our sparsity pattern is tailored for pathology and is theoretically proven to be a universal approximator with the tightest probabilistic sharp bound on the number of layers for sparse transformers, to date. We demonstrate Snuffy's effectiveness on CAMELYON16 and TCGA Lung cancer datasets, achieving superior WSI and patch-level accuracies. The code is available on https://github.com/jafarinia/snuffy.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <p>
            Snuffy architecture comprises two key components: <br>
            <strong> 1) Self-Supervised Continual Pre-Training with PEFT:</strong> We leverage Parameter Efficient Fine Tuning (PEFT) in the pathology domain, utilizing the Adaptformer due to its effective design. <br>
            <strong> 2) Snuffy MIL-Pooling Architecture:</strong> Inspired by the complexity of cancer biology and the tissue microenvironment's role in detection, we present the Snuffy MIL-pooling architecture. This architecture introduces a new sparsity pattern for sparse transformers.
          </p>
        </div>
      </div>
    </div>
    <!--/ Method. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Comparison. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Comparison</h2>
        <div class="content has-text-justified">
          <p>
            There are two families within our architecture: <br>
            <strong> Efficient Snuffy:</strong> Trained initially on a natural image dataset, followed by continued training with PEFT on whole-slide images (WSIs). <br>
              <strong> Exhaustive Snuffy:</strong> Trained from scratch on WSIs.
Both families utilize the Snuffy MIL-pooling architecture.
          </p>
          <img src="static/images/comparison.png" class="center">
        <figcaption class="has-text-justified">Performance (AUC) vs. efficiency (size and time) trade off on CAMELYON16. Although the performance of Efficient Snuffy may be slightly inferior to Exhaustive Snuffy, both methods significantly outperform existing benchmarks in Region-of-Interest (ROI) detection and WSI
          classification, setting a new state-of-the-art (SOTA)</figcaption>

        </div>
      </div>
    </div>
    <!--/ Comparison. -->
  </div>
</section>

<!-- Visualization. -->
<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Region of Interests</h2>

        <img src="static/images/heatmap.png" class="center">
        <figcaption class="has-text-justified">Qualitative view of ROIs recognized by Suffy through its Patch Classification. (a) An example WSI from the test set of the CAMELYON16 dataset. (b) ROIs are identified by Snuffy with black lines delineating the ground truth ROIs.</figcaption>

      </div>
    </div>

  </div>
</section>
<!-- Visualization. -->


<!-- Citation. -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@misc{jafarinia2024snuffyefficientslideimage,
      title={Snuffy: Efficient Whole Slide Image Classifier}, 
      author={Hossein Jafarinia and Alireza Alipanah and Danial Hamdi and Saeed Razavi and Nahal Mirzaie and Mohammad Hossein Rohban},
      year={2024},
      eprint={2408.08258},
      archivePrefix={arXiv},
      primaryClass={cs.CV},
      url={https://arxiv.org/abs/2408.08258}, 
}</code></pre>
  </div>
</section>
<!-- Citation. -->


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="https://arxiv.org/pdf/2408.08258" target="_blank" style="text-decoration : none">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/jafarinia/snuffy" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content has-text-centered">
          <p>
            Template was borrowed from <a
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>
          under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>Please contact us for feedback and questions.</p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
